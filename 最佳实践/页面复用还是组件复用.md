##### 背景
在做管理后台的过程中，常常能遇到

1. 多个功能模块页面显示基本相同，只是业务类型不同。

2. 或者新增页面和编辑页面基本相同，逻辑不同

这种页面看似相同，逻辑却有差异的场景。

##### 实现方案

1. 页面层面做复用。
>即页面基本相似的不同业务功能模块复用一套代码，然后在代码里面做不同场景的兼容。比如新增和编辑页面，可以维护一个变量
isAdd区分来是新增或者编辑的页面。然后通过isAdd区分不同的逻辑，比如新增页面就调新增的接口，编辑页面就调保存的接口。


>这种做法有潜在的风险。一套代码里面兼容不同的业务场景，常常隐藏着业务功能迭代带来的逻辑更改或者部分页面显示的变化。后面发现兼容来兼容去
代码不仅变得难以维护难以理解，有时候还会发现改不动。

>这种做法基本已经不用了，实践过程中还是有血的教训。


2. 组件层面复用。
> 合理划分页面，拆分成许许多多的功能逻辑全面的小组件。然后组件复用

##### 案例分析

![image](https://github.com/lizuncong/Front-End-Development-Notes/blob/master/resource/pageVsComponent.jpg)

如图所示，可以发现新增页面和编辑页面相似度达到了99%：

1. 新增页面有提交按钮，编辑页面没有

2. 新增页面没有删除，编辑页面有删除

3. 新增页面没有进度，编辑页面有进度

两个页面的交互：

1. 新增页面所有的用户填写的信息，最后点击提交时才调接口把这些信息提交到后端

2. 编辑页面没有保存按钮，因此一旦用户修改信息，就立即调相应的接口保存修改的信息

3. 我的对齐弹窗以及添加对齐弹窗，在两个页面调的接口参数及后段url不同。

4. 点击p1，p2，p3，输入框1可见并自动聚焦。

5. 点击权重按钮，弹出设置权重弹窗。

理论上可以通过页面复用的方式实现。比如写一个页面实现这些功能，然后通过变量，比如isAdd
判断是新增或者编辑页面，比如isAdd为true就显示提交按钮，隐藏删除按钮。然后在用户修改信息时，如果isAdd为true，就不用调接口，直接前端缓存，
如果isAdd为false，用户修改信息时，直接调相应的接口保存并重新获取详情页的信息。这样实现，会发现业务代码里面参杂了太多的判断逻辑，不易于维护及
理解。如果后面业务需求变了，编辑页面和新增页面显示有差异时，改动就很麻烦。

因此这里我没有采取页面复用的方式。而是在组件层面做了复用。首先组件划分如下：

1. 输入框1封装成一个组件，输入框聚焦，@用户的逻辑封装在组件里面。

2. 添加objective一个组件

3. 添加对齐那一行一个组件，该组件需要注意两点：点击"添加对齐"弹出添加对齐的弹窗，点击头像，弹出我的对齐弹窗；需要判断是新增页面还是编辑页面，
从而调用相应的接口

4. p2封装成一个组件

5. p3封装成一个组件，其中每添加一项，都要根据规则重新计算每一项的权重

6. 权重按钮一个组件，点击权重弹出设置权重弹窗。

每一个组件都抛出onChange的api

这样，将所有的组件组装一下，就能分别组成新增页面和编辑页面。两个页面的处理逻辑：

新增页面实现各个组件的onchange方法，修改相应的信息。

编辑页面实现各个组件的onchange方法，直接根据onchange方法的参数调用相应的后端接口保存相应的信息。然后调用详情接口重新获取详情数据。


这样就能够高度复用组件，而且维护简单，组件脱离了业务逻辑判断(即判断新增页面还是编辑页面等等)。后期就算业务再怎么变化，也是组件层面的小修改。

***不过这样做的弊端就是，如果是两个人分别负责新增页面和编辑页面的业务模块开发，那么就需要等待这些组件开发完成才能往下开发。***
